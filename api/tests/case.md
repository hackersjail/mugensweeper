# （１）プレーヤー登録

## ゲーム参加

1.  プレーヤー名をテキストボックスに入力し、新たなルームを作成するか、既存のルームを選択する

   1. 既存のルームを選択した場合

      1. プレーヤー名をテキストボックスに入力せず、且つ、localstorage にプレーヤーを識別する値が既に DB にあった場合
         1. 既存プレーヤーとして、現在のプレー途中からそのゲームに参加
      1. プレーヤー名をテキストボックスに入力、且つ、localstorage にプレーヤーを識別する値が既に DB にあった場合
         1. メッセージを返し、既存プレーヤーとして現在のプレー途中から参加するか、新たなプレーヤー名で現在のプレー途中から参加するか、又は、プレー途中で完全退出するかを選択
      1. 新たなプレーヤーとして参加し直す場合
         1. 既存プレーヤーの識別値を localstorage と DB から削除。新たな識別値を localstorage と DB に登録
         1. x=0,y=0 のブロックが開いた状態の初期画面を表示
         1. 人数が揃ったら開始ボタンを押すための modal を表示

   1. 新たなルーム作成を選択した場合
      1. プレーヤーの識別値を localstorage と DB に登録
      1. ゲームルールを選択
         1. プレーヤー人数を選択
            1. コンピュータープレーヤーを何名加えるかも同時に選択
         1. ゲーム内容の選択
            1. 制限時間内に最高得点を競う
            1. 目標得点を最速で取得することを競う 
      1. x=0,y=0 のブロックが開いた状態の初期画面を表示
      1. 人数が揃ったら開始ボタンを押すための modal を表示

# （２）ゲーム開始後のプレーヤーの動作

## 開けるブロックについて

1.  プレーヤーは、既に開いたブロックの上下左右ナナメのどこかのみ開く事が可能
1. ブロックを開くには左クリックする。
1. 爆弾が無いブロックに右クリックで旗を立てたり、既に旗が立っているブロックを右クリックで元に戻す事が可能
1.  旗が立っているブロックを除く、既に開いたブロック  に対し、開く動作をしたり、旗を立てたり、 開く前の状態にする事は不可
1. 爆弾があるブロックを開いた時点でゲームは終了し、その時点の取得点数で順位を確定（爆弾があるブロックを開いたプレーヤーは取得得点に関係なく最下位）
1. コンピュータープレーヤーは 3 秒おきにブロックを開く

## 取得点数

1. １ブロック開くごとにプレーヤーは１点プラス
1. 爆弾が無いブロックに旗を立てた場合は１点マイナス
1. 取得点数の総数がマイナスになった時点でゲームは終了し、その時点の取得点数で順位を確定

## 連鎖爆発

1.  プレーヤーが開いたブロックが爆弾が無いブロックであれば、そのブロック上下左右ナナメのブロックを連鎖的に  開いていく 。 連鎖的に開いたブロック上下左右ナナメにも爆弾が無ければ、連鎖的にブロックは開き続けていく。
1. 連鎖的に開いたブロック 1 つにつき、プレーヤーは１点を取得

##  途中退出

1.  意図的にプレーヤーが途中退出する場合はその時点でゲームは終了し、その時点の取得点数で順位を確定（途中退出した場合は）
1. インターネットアクセスなど不意に途中退出となった場合、ゲーム自体は別プレーヤー間で継続。

# （３）ゲーム終了後のプレーヤーの動作

## ゲーム終了後の選択

1. 現ルーム内での再戦を希望するか、当ルームから退出するか、ゲーム自体から退出するかを選択
   1. 現ルーム内での再戦を希望する場合
      1.  盤面情報をリセットし、x=0,y=0 のブロックが開いた状態の初期画面を表示
      1. 人数が揃ったら開始ボタンを押すための modal を表示
   1. 当ルームから退出する場合
      1. 既存ルームに関する情報を localstorage と DB から削除。
   1. ゲーム自体から退出する場合
      1. 既存ルームに関する情報を localstorage と DB から削除。
